{{- $releaseName := .Release.Name -}}
{{- $chartName := include "osmdbt-wrapper.name" . -}}
{{- if .Values.enabled -}}
apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ $releaseName }}-{{ $chartName }}-configmap
data:
  {{- with .Values.dbConfig.sslAuth }}
  POSTGRES_ENABLE_SSL_AUTH: {{ .enabled | quote }}
  {{- if .enabled }}
  POSTGRES_CERTS_MOUNT_PATH: {{ .mountPath | quote }}
  {{- end }}
  {{- end }}
  {{- with .Values.objectStrorageConfig }}
  OBJECT_STORAGE_ENDPOINT: {{ .endpoint | quote }}
  OBJECT_STORAGE_BUCKET_NAME: {{ .bucketName | quote }}
  OBJECT_STORAGE_ACL: {{ .acl | quote }}
  {{- end }}
  OSMDBT_CHANGES_DIR: {{ .Values.osmdbt.changesDir | default "/tmp" | quote }}
  OSMDBT_LOG_DIR: {{ .Values.osmdbt.logDir | default "/tmp/log" | quote }}
  OSMDBT_RUN_DIR: {{ .Values.osmdbt.runDir | default "/tmp" | quote }}
  OSMDBT_GET_LOG_MAX_CHANGES: {{ .Values.osmdbt.getLogMaxChanges | quote }}
  {{- if .Values.osmdbt.verbose }}
  OSMDBT_VERBOSE: "true"
  {{- else }}
  OSMDBT_VERBOSE: "false"
  {{- end }}
{{- end -}}
