{{- $releaseName := .Release.Name -}}
{{- $chartName := include "osmdbt-wrapper.name" . -}}
{{- if .Values.enabled -}}
apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ $releaseName }}-{{ $chartName }}-osmdbt-configmap
data:
  osmdbt-config.yaml: |-
    database:
      host: {{ .Values.dbConfig.host }}
      port: 5432
      dbname: {{ .Values.dbConfig.database }}
      user: {{ .Values.dbConfig.username }}
      password: {{ .Values.dbConfig.password }}
      replication_slot: {{ .Values.application.replicationSlotName }}
    log_dir: {{ .Values.application.logDir | default "/tmp" }}
    changes_dir: {{ .Values.application.changesDir | default "/tmp" }}
    tmp_dir: {{ .Values.application.tmpDir | default "/tmp" }}
    run_dir: {{ .Values.application.runDir | default "/tmp" }}
{{- end -}}
